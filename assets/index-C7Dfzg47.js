(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();class ae{constructor(){}static APPLY_COUNTED(e,t){return t.replace("{count}",e.toString())}static TIME_LOCALE="en";static TIME_YESTERDAY="yesterday";static TIME_HOURS_AGO="{count} hour(s) ago";static TIME_MINUTES_AGO="{count} minute(s) ago";static TIME_SECONDS_AGO="{count} second(s) ago";static TIME_TODAY_AT="today at";static TIME_JUST_NOW="just now";static APPNAME="QuackNorris Chat"}class We extends ae{static TIME_LOCALE="de";static APPNAME="QuackNorris Chat"}let se=ae;function Ge(){switch(localStorage.language){case"de":se=We;break;case"en":case"us":default:se=ae;break}}class Ze{constructor(e,t){this.defaultPage=e,this.pages=t;for(const n in t)document.getElementById("app")?.appendChild(t[n].htmlElement),t[n].hide();window.onhashchange=n=>{this.onOpen()},location.hash.slice(1)==""?location.hash="#"+e:this.onOpen()}static DEBUG=!1;currentPage="";onOpen(){let e={},t=location.hash.slice(1);t.length==0&&(t=this.defaultPage);let n=t.split("&"),s=n[0];n=n.splice(1);for(const o of n){let l=o.split("="),c=decodeURIComponent(l[0]),a=decodeURIComponent(l[1]);e[c]=a}let r=this.currentPage!=s;r&&(this.pages[this.currentPage]?.hide(),this.currentPage=s,this.pages[this.currentPage]?.show()),this.pages[this.currentPage]?.update(e,r)}static open(e,t){window.setTimeout(()=>{let n="";for(let s in t)n+="&"+encodeURIComponent(s)+"="+encodeURIComponent(t[s]);location.hash="#"+encodeURIComponent(e)+n},200)}static update(e){let n=location.hash.slice(1).split("&"),s=n[0];n=n.splice(1);for(const r of n){let o=r.split("="),l=decodeURIComponent(o[0]),c=decodeURIComponent(o[1]);e.hasOwnProperty(l)||(e[l]=c)}window.setTimeout(()=>{let r="";for(let o in e)r+="&"+encodeURIComponent(o)+"="+encodeURIComponent(e[o]);location.hash="#"+encodeURIComponent(s)+r},200)}static back(){history.back()}}class g{parent=null;htmlElement;_displayStyle="none";_children=[];constructor(e,t="",n=""){this.htmlElement=document.createElement(e),this.htmlElement.innerHTML=t,n!=""&&this.setClass(n)}add(e){this._children.push(e),this.htmlElement.appendChild(e.htmlElement),e.parent=this}getChildren(){return this._children}removeChildren(){this.htmlElement.innerHTML="",this._children=[]}addHtml(e,t,n=""){const s=document.createElement(e);return s.innerHTML=t,n!=""&&s.classList.add(n),this.htmlElement.appendChild(s),s}remove(e){let t=this._children.indexOf(e);t>=0&&(this._children=this._children.splice(0,t).concat(this._children.splice(t+1))),this.htmlElement.removeChild(e.htmlElement),e.parent=null}removeHTML(e){this.htmlElement.removeChild(e)}isVisible(){return this.htmlElement.style.display.toLowerCase()!="none"}hide(){this.isVisible()&&(this._displayStyle=this.htmlElement.style.display,this.htmlElement.style.display="None")}show(){this._displayStyle.toLowerCase()!="none"&&(this.htmlElement.style.display=this._displayStyle)}update(e,t){}select(){this.setClass("selected")}unselect(){this.unsetClass("selected")}setClass(e){this.hasClass(e)||this.htmlElement.classList.add(e)}unsetClass(e){this.hasClass(e)&&this.htmlElement.classList.remove(e)}hasClass(e){return this.htmlElement.classList.contains(e)}}let Je='<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"/></svg>',Qe='<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M192 0C139 0 96 43 96 96l0 160c0 53 43 96 96 96s96-43 96-96l0-160c0-53-43-96-96-96zM64 216c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40c0 89.1 66.2 162.7 152 174.4l0 33.6-48 0c-13.3 0-24 10.7-24 24s10.7 24 24 24l72 0 72 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-48 0 0-33.6c85.8-11.7 152-85.3 152-174.4l0-40c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40c0 70.7-57.3 128-128 128s-128-57.3-128-128l0-40z"/></svg>',Ke='<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M164.9 24.6c-7.7-18.6-28-28.5-47.4-23.2l-88 24C12.1 30.2 0 46 0 64C0 311.4 200.6 512 448 512c18 0 33.8-12.1 38.6-29.5l24-88c5.3-19.4-4.6-39.7-23.2-47.4l-96-40c-16.3-6.8-35.2-2.1-46.3 11.6L304.7 368C234.3 334.7 177.3 277.7 144 207.3L193.3 167c13.7-11.2 18.4-30 11.6-46.3l-40-96z"/></svg>',Ve='<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480l0-83.6c0-4 1.5-7.8 4.2-10.8L331.8 202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg>',q='<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"/></svg>',K='<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M135.2 17.7L128 32 32 32C14.3 32 0 46.3 0 64S14.3 96 32 96l384 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0-7.2-14.3C307.4 6.8 296.3 0 284.2 0L163.8 0c-12.1 0-23.2 6.8-28.6 17.7zM416 128L32 128 53.2 467c1.6 25.3 22.6 45 47.9 45l245.8 0c25.3 0 46.3-19.7 47.9-45L416 128z"/></svg>',ie='<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M248 106.6c18.9-9 32-28.3 32-50.6c0-30.9-25.1-56-56-56s-56 25.1-56 56c0 22.3 13.1 41.6 32 50.6l0 98.8c-2.8 1.3-5.5 2.9-8 4.7l-80.1-45.8c1.6-20.8-8.6-41.6-27.9-52.8C57.2 96 23 105.2 7.5 132S1.2 193 28 208.5c1.3 .8 2.6 1.5 4 2.1l0 90.8c-1.3 .6-2.7 1.3-4 2.1C1.2 319-8 353.2 7.5 380S57.2 416 84 400.5c19.3-11.1 29.4-32 27.8-52.8l50.5-28.9c-11.5-11.2-19.9-25.6-23.8-41.7L88 306.1c-2.6-1.8-5.2-3.3-8-4.7l0-90.8c2.8-1.3 5.5-2.9 8-4.7l80.1 45.8c-.1 1.4-.2 2.8-.2 4.3c0 22.3 13.1 41.6 32 50.6l0 98.8c-18.9 9-32 28.3-32 50.6c0 30.9 25.1 56 56 56s56-25.1 56-56c0-22.3-13.1-41.6-32-50.6l0-98.8c2.8-1.3 5.5-2.9 8-4.7l80.1 45.8c-1.6 20.8 8.6 41.6 27.8 52.8c26.8 15.5 61 6.3 76.5-20.5s6.3-61-20.5-76.5c-1.3-.8-2.7-1.5-4-2.1l0-90.8c1.4-.6 2.7-1.3 4-2.1c26.8-15.5 36-49.7 20.5-76.5S390.8 96 364 111.5c-19.3 11.1-29.4 32-27.8 52.8l-50.6 28.9c11.5 11.2 19.9 25.6 23.8 41.7L360 205.9c2.6 1.8 5.2 3.3 8 4.7l0 90.8c-2.8 1.3-5.5 2.9-8 4.6l-80.1-45.8c.1-1.4 .2-2.8 .2-4.3c0-22.3-13.1-41.6-32-50.6l0-98.8z"/></svg>',Ie='<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M362.7 19.3L314.3 67.7 444.3 197.7l48.4-48.4c25-25 25-65.5 0-90.5L453.3 19.3c-25-25-65.5-25-90.5 0zm-71 71L58.6 323.5c-10.4 10.4-18 23.3-22.2 37.4L1 481.2C-1.5 489.7 .8 498.8 7 505s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L421.7 220.3 291.7 90.3z"/></svg>',Ye='<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M192 0c-41.8 0-77.4 26.7-90.5 64L64 64C28.7 64 0 92.7 0 128L0 448c0 35.3 28.7 64 64 64l256 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64l-37.5 0C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192l160 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-160 0c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg>',Xe='<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M105.1 202.6c7.7-21.8 20.2-42.3 37.8-59.8c62.5-62.5 163.8-62.5 226.3 0L386.3 160 352 160c-17.7 0-32 14.3-32 32s14.3 32 32 32l111.5 0c0 0 0 0 0 0l.4 0c17.7 0 32-14.3 32-32l0-112c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 35.2L414.4 97.6c-87.5-87.5-229.3-87.5-316.8 0C73.2 122 55.6 150.7 44.8 181.4c-5.9 16.7 2.9 34.9 19.5 40.8s34.9-2.9 40.8-19.5zM39 289.3c-5 1.5-9.8 4.2-13.7 8.2c-4 4-6.7 8.8-8.1 14c-.3 1.2-.6 2.5-.8 3.8c-.3 1.7-.4 3.4-.4 5.1L16 432c0 17.7 14.3 32 32 32s32-14.3 32-32l0-35.1 17.6 17.5c0 0 0 0 0 0c87.5 87.4 229.3 87.4 316.7 0c24.4-24.4 42.1-53.1 52.9-83.8c5.9-16.7-2.9-34.9-19.5-40.8s-34.9 2.9-40.8 19.5c-7.7 21.8-20.2 42.3-37.8 59.8c-62.5 62.5-163.8 62.5-226.3 0l-.1-.1L125.6 352l34.4 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L48.4 288c-1.6 0-3.2 .1-4.8 .3s-3.1 .5-4.6 1z"/></svg>',et='<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M0 416c0 17.7 14.3 32 32 32l54.7 0c12.3 28.3 40.5 48 73.3 48s61-19.7 73.3-48L480 448c17.7 0 32-14.3 32-32s-14.3-32-32-32l-246.7 0c-12.3-28.3-40.5-48-73.3-48s-61 19.7-73.3 48L32 384c-17.7 0-32 14.3-32 32zm128 0a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zM320 256a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm32-80c-32.8 0-61 19.7-73.3 48L32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l246.7 0c12.3 28.3 40.5 48 73.3 48s61-19.7 73.3-48l54.7 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-54.7 0c-12.3-28.3-40.5-48-73.3-48zM192 128a32 32 0 1 1 0-64 32 32 0 1 1 0 64zm73.3-64C253 35.7 224.8 16 192 16s-61 19.7-73.3 48L32 64C14.3 64 0 78.3 0 96s14.3 32 32 32l86.7 0c12.3 28.3 40.5 48 73.3 48s61-19.7 73.3-48L480 128c17.7 0 32-14.3 32-32s-14.3-32-32-32L265.3 64z"/></svg>';class N extends g{disabled=!1;constructor(e,t="button"){super("a",e,t),this.htmlElement.onclick=n=>{this.disabled||(n.stopPropagation(),this.onClick())}}onClick(){console.log("Buttom::onClick: Not implemented! Must be implemented by subclass.")}disable(){this.disabled=!0,this.setClass("disabled")}enable(){this.disabled=!1,this.unsetClass("disabled")}}class B extends g{constructor(e,t,n,s="formInput"){super("input","",s),this.htmlElement.name=e,this.htmlElement.placeholder=t,this.htmlElement.type=n,this.htmlElement.oninput=()=>{this.onChange(this.htmlElement.value)},this.htmlElement.onchange=()=>{this.onChangeDone(this.htmlElement.value)}}value(e=void 0){return e!==void 0&&(this.htmlElement.value=e),this.htmlElement.value}onChange(e){}onChangeDone(e){}}class xe extends g{constructor(e,t="h1",n="formHeading"){super(t,e,n)}}class te extends g{constructor(e,t="formLabel"){super("label",e,t)}}class _e extends N{onClick(){this.parent.submit()}}class L extends g{constructor(e,t=null){super("span",e,"action"),this.action=t,this.htmlElement.onclick=()=>this.onAction()}onAction(){this.action!=null?this.action():(alert("Not implemented yet!"),console.log("Overwrite onAction() or provide an acction callback in the constructor."))}}class be extends g{constructor(e,t=null,n=!1){super("span",e,"dropdown"),this.selections=t,this.filterable=n,this.htmlElement.onclick=()=>this.onAction()}setOptions(e){this.selections=e}onAction(){this.selections!=null?this.showMenu(this.selections):(alert("No selections available."),console.log("No selections for this dropdown button available, set them via setOptions() or the constructor."))}showMenu(e){let t=new tt(e,this.filterable);t.htmlElement.style.display="block",t.htmlElement.style.position="absolute";const n=this.htmlElement.getBoundingClientRect();let s=(n.left+n.right)/2,r=(n.top+n.bottom)/2,o=window.innerWidth,l=window.innerHeight,c=o-s;l-r<t.htmlElement.clientHeight?t.htmlElement.style.top=`${n.top-t.htmlElement.clientHeight}px`:t.htmlElement.style.top=`${n.bottom}px`,c<t.htmlElement.clientWidth?t.htmlElement.style.left=`${n.right-t.htmlElement.clientWidth}px`:t.htmlElement.style.left=`${n.left}px`}}class tt extends g{background;constructor(e,t=!1){super("div","","dropdown-menu");let n=new g("div");if(t){let s=new B("filter","model name","text");s.onChange=r=>{this.updateOptions(n,e,r)},this.add(s)}this.add(n),this.updateOptions(n,e),this.background=new g("div","","dropdown-menu-grayout"),this.background.htmlElement.onclick=()=>{this.close()},document.body.appendChild(this.background.htmlElement),document.body.appendChild(this.htmlElement)}updateOptions(e,t,n=""){e.htmlElement.innerHTML="";for(let[s,r]of t)if(s.includes(n)){let o=new N(s,"dropdown-menu-button");o.onClick=()=>{r()&&this.close()},e.add(o)}}close(){document.body.removeChild(this.background.htmlElement),document.body.removeChild(this.htmlElement)}}let nt='<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg>',st='<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 352 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"/></svg>';class Ae extends g{container;constructor(e="popupContent",t="popupContainer"){super("div"),this.setClass(e),this.container=new g("div"),this.container.setClass(t),this.container.add(this),document.getElementById("global")?.appendChild(this.container.htmlElement)}dispose(){this.onExit(),document.getElementById("global")?.removeChild(this.container.htmlElement)}onExit(){}update(){}}class j extends Ae{constructor(e,t,n,s="popupContent",r="popupContainer"){super(s,r),this.add(new g("p",e));let o=new N(t,"popupConfirmBtn");o.onClick=()=>{this.dispose(),this.onConfirm()},this.add(o);let l=new N(n,"popupCancelBtn");l.onClick=()=>{this.dispose(),this.onCancel()},this.add(l)}onConfirm(){console.log("ConfirmCancelPopup::onConfirm not implemented. Must be implemented by subclass.")}onCancel(){console.log("ConfirmCancelPopup::onCancel not implemented. Must be implemented by subclass.")}}class $e extends Ae{constructor(e="popupContent",t="popupContainer",n="popupExitBtn"){super(e,t);let s=new N(st,n);s.onClick=this.dispose.bind(this),this.add(s)}update(){}}class it{onExtendText(e){}}class ne{constructor(e="",t=[],n="user"){this.text=e,this.images=t,this.role=n}listeners=[];addListener(e){this.listeners.push(e)}removeListener(e){let t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1)}getText(){return this.text}getImages(){return this.images}getRole(){return this.role}extendText(e){this.text+=e;for(let t of this.listeners)t.onExtendText(e)}}class A{static instance=new A;static getInstance(){return this.instance}connections=new Map;constructor(){localStorage["quack-norris-llms"]&&localStorage["quack-norris-llms"]!="[]"?this.connections=new Map(JSON.parse(localStorage["quack-norris-llms"])):this.addConnection("local","http://localhost:11435","")}getConnections(){return Array.from(this.connections.values())}async addConnection(e,t,n){return this.connections.set(e,{name:e,apiEndpoint:t,apiKey:n}),localStorage["quack-norris-llms"]=JSON.stringify(Array.from(this.connections.entries())),!0}removeConnection(e){return this.connections.delete(e.name),localStorage["quack-norris-llms"]=JSON.stringify(Array.from(this.connections.entries())),!0}async getModels(){let e=[];for(let t of this.getConnections())try{let s=await(await fetch(t.apiEndpoint+"/models",{method:"GET",headers:{Authorization:`Bearer ${t.apiKey}`,"Content-Type":"application/json"}})).json();for(let r of s.data){let o=t.name+"/"+r.id;e.push(o)}}catch{console.log("Failed to connect to "+t.apiEndpoint)}return e.sort()}async getWorkspaces(e){let t=[],[n,s]=e.split("/"),r=this.connections.get(n);if(!r)return console.log("Unknown connection for "+e),t;try{t=await(await fetch(r.apiEndpoint+"/workspaces",{method:"GET",headers:{Authorization:`Bearer ${r.apiKey}`,"Content-Type":"application/json"}})).json()}catch{return console.log("Server does not support workspaces or failed to connect to "+r.apiEndpoint),t}return t}async*stream(e,t,n){let[s,r]=e.split("/"),o=this.connections.get(s);if(!o){yield"ERROR: The model '"+e+"' is unavailable. Check your llm connections.";return}let l=this.messagesToOpenAIFormat(n);try{const a=(await fetch(o.apiEndpoint+"/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${o.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({model:r,messages:l,stream:!0,workspace:t})})).body?.pipeThrough(new TextDecoderStream).getReader();if(!a)return;for(;;){const{value:p,done:x}=await a.read();if(x)break;const d=p.split(`
`);for(let v of d){if(v.length===0||v.startsWith(":"))continue;if(v==="data: [DONE]")return;yield JSON.parse(v.substring(6)).choices[0].delta.content}}}catch{yield`

ERROR: Failed to retrieve answer from the LLM.`}}messagesToOpenAIFormat(e){let t=[];for(let n of e){let s=[{type:"text",text:n.getText()}];for(let o of n.getImages())s.push({type:"image_url",image_url:{url:o}});let r=n.getRole();r!="user"&&r!="system"&&(r="assistant"),t.push({role:r,content:s})}return t}}let U;const rt=new Uint8Array(16);function ot(){if(!U&&(U=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!U))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return U(rt)}const S=[];for(let i=0;i<256;++i)S.push((i+256).toString(16).slice(1));function lt(i,e=0){return S[i[e+0]]+S[i[e+1]]+S[i[e+2]]+S[i[e+3]]+"-"+S[i[e+4]]+S[i[e+5]]+"-"+S[i[e+6]]+S[i[e+7]]+"-"+S[i[e+8]]+S[i[e+9]]+"-"+S[i[e+10]]+S[i[e+11]]+S[i[e+12]]+S[i[e+13]]+S[i[e+14]]+S[i[e+15]]}const at=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ve={randomUUID:at};function ye(i,e,t){if(ve.randomUUID&&!i)return ve.randomUUID();i=i||{};const n=i.random||(i.rng||ot)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,lt(n)}class ce{onConversationAdded(e,t,n){}onConversationRenamed(e,t,n){}onConversationModified(e,t,n){}onConversationRemoved(e){}onConversationSelected(e,t){}}class h{constructor(){}static listeners=[];static currentConversation=null;static addListener(e){h.listeners.push(e)}static removeListener(e){let t=h.listeners.indexOf(e);t>=0&&h.listeners.splice(t,1)}static clearListeners(){h.listeners=[]}static getConversations(){return localStorage["quack-norris-conversations"]?JSON.parse(localStorage["quack-norris-conversations"]):{}}static saveConversation(e){let t=e.getID();if(t=="")throw Error("Cannot save conversation without an ID.");let n=h.getConversations();if(!n[t])throw Error("Invalid ID, ID does not exist and cannot be renamed. ID: "+t);let s=new Date().toISOString();n[t].modified=s,localStorage["quack-norris-conversations"]=JSON.stringify(n),localStorage["quack-norris-conversation-"+t]=e.toJSON();for(let r of h.listeners)r.onConversationModified(t,n[t].name,n)}static selectConversation(e){if(!h.getConversations()[e]||!localStorage["quack-norris-conversation-"+e])return!1;if(h.currentConversation?.getID()==e)return!0;h.currentConversation=G.fromJSON(e,localStorage["quack-norris-conversation-"+e]);for(let n of h.listeners)n.onConversationSelected(e,h.currentConversation);return!0}static getCurrentConversation(){return h.currentConversation}static newConversation(){let e=localStorage["quack-norris-default-model"]||"local/agent.auto",t=new G(e),n=h.addConversation("unnamed",t);h.selectConversation(n)}static addConversation(e,t){let n=h.getConversations(),s=ye();for(;n[s];)s=ye();t.setID(s);let r=new Date().toISOString();n[s]={name:e,modified:r},localStorage["quack-norris-conversations"]=JSON.stringify(n),h.saveConversation(t);for(let o of h.listeners)o.onConversationAdded(s,e,r);return s}static renameConversation(e,t){let n=h.getConversations();if(!n[e])throw Error("Invalid ID, ID does not exist and cannot be renamed. ID: "+e);let s=new Date().toISOString();n[e]={name:t,modified:s},localStorage["quack-norris-conversations"]=JSON.stringify(n);for(let r of h.listeners)r.onConversationRenamed(e,t,s)}static removeConversation(e){let t=h.getConversations();if(!t[e])throw Error("Invalid ID, ID does not exist and cannot be renamed. ID: "+e);delete t[e],delete localStorage["quack-norris-conversation-"+e],localStorage["quack-norris-conversations"]=JSON.stringify(t);for(let n of h.listeners)n.onConversationRemoved(e)}}class ze{onMessageAdded(e){}onMessageDeletedFrom(e,t){}onModelChanged(e){}onWorkspaceChanged(e){}onSettingChanged(e,t){}onDraftChanged(e,t){}}class G{constructor(e="",t=[],n="Unnamed Chat",s="",r="",o=[]){this.model=e,this.messages=t,this.name=n,this.workspace=s,this.draft_text=r,this.draft_images=o}listeners=[];id="";static fromJSON(e,t){let n=JSON.parse(t),s=[];for(let o of n.messages)s.push(new ne(o.text,o.images,o.role));let r=new G(n.model,s,n.name,n.workspace,n.draft_text,n.draft_images);return r.setID(e),r}toJSON(){return JSON.stringify({model:this.model,messages:this.messages,name:this.name,workspace:this.workspace,draft_text:this.draft_text,draft_images:this.draft_images})}setID(e){this.id=e}getID(){return this.id}getName(){return this.name}setName(e){this.name=e;for(let t of this.listeners)t.onSettingChanged("name",e);h.saveConversation(this)}addListener(e){this.listeners.push(e)}removeListener(e){let t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1)}clearListeners(){this.listeners=[]}getModel(){return this.model}setModel(e){this.model=e;for(let t of this.listeners)t.onModelChanged(e);h.saveConversation(this)}getWorkspace(){return this.workspace}setWorkspace(e){this.workspace=e;for(let t of this.listeners)t.onWorkspaceChanged(e);h.saveConversation(this)}getMessages(){return this.messages}addMessage(e){this.messages.push(e);for(let t of this.listeners)t.onMessageAdded(e);h.saveConversation(this)}deleteMessages(e){let t=this.messages.indexOf(e);if(t>=0){this.messages=this.messages.slice(0,t);for(let n of this.listeners)n.onMessageDeletedFrom(t,e);h.saveConversation(this)}}async sendMessage(e,t){this.addMessage(new ne(e,t,"user"));let n=this.getMessages().slice(),s=A.getInstance().stream(this.model,this.workspace,n),r=new ne("",[],this.model);this.addMessage(r);for await(let o of s)r.extendText(o);h.saveConversation(this)}setDraftText(e){this.draft_text=e;for(let t of this.listeners)t.onDraftChanged(this.draft_text,this.draft_images);h.saveConversation(this)}getDraftText(){return this.draft_text}setDraftImages(e){this.draft_images=e;for(let t of this.listeners)t.onDraftChanged(this.draft_text,this.draft_images);h.saveConversation(this)}getDraftImages(){return this.draft_images}}class ct extends g{input;send;call;constructor(){super("div","","chat-input");let e=new g("div","","container"),t=new g("div","","media");t.hide(),e.add(t),this.input=new g("textarea"),this.input.htmlElement.placeholder="Why is the sky blue?",e.add(this.input);let n=new g("div","","tool-bar"),s=new L(Je);n.add(s);let r=new g("span","","fill-width"),o=new be(ie+" loading... "+q,null,!0);function l(u){u=u.split("/").splice(1).join("/"),o.htmlElement.innerHTML=ie+" "+u+" "+q}let c=h.getCurrentConversation();c&&l(c.getModel()),o.onAction=async()=>{let u=await A.getInstance().getModels(),b=new Map;for(let f of u){let y=f;y.startsWith("local/")&&(y=y.replace("local/","")),b.set(y,async()=>{let C=h.getCurrentConversation(),X=await A.getInstance().getWorkspaces(f);return C&&(C.setModel(f),l(f),X.includes(C.getWorkspace())||C.setWorkspace("")),!0})}o.showMenu(b)},r.add(o);let a=new be("loading... "+q,null,!0);function p(u){u==""&&(u="(none)"),a.htmlElement.innerHTML=" "+u+" "+q}c&&p(c.getWorkspace()),a.onAction=async()=>{let u=h.getCurrentConversation();if(u){let b=await A.getInstance().getWorkspaces(u.getModel());b.unshift("");let f=new Map;for(let y of b){let C=y!=""?y:"(none)";f.set(C,()=>(u.setWorkspace(y),p(y),!0))}a.showMenu(f)}},r.add(a),n.add(r);let x=new L(Qe);n.add(x),this.call=new L(Ke),n.add(this.call),this.send=new L(Ve),this.send.hide(),n.add(this.send),e.add(n),this.add(e),this.input.htmlElement.onkeyup=u=>{this.input.htmlElement.value!=""&&u.ctrlKey&&u.key=="Enter"&&this.send.onAction(),this.onUpdateInput()},this.send.onAction=()=>{let u=h.getCurrentConversation();if(!u)return;let b=this.input.htmlElement.value,f=[];for(let y of t.getChildren()){let C=y;f.push(C.getImageURL())}t.removeChildren(),t.hide(),u.sendMessage(b,f),this.input.htmlElement.value="",this.onUpdateInput(),u.setDraftText(this.input.htmlElement.value)},this.input.htmlElement.addEventListener("paste",async u=>{const b=typeof navigator?.clipboard?.read=="function"?await navigator.clipboard.read():u.clipboardData.files;for(const f of b)if(f instanceof File&&["image/png","image/jpeg"].includes(f.type))v(f),u.preventDefault();else if(f instanceof ClipboardItem){const y=f.types?.filter(C=>["image/png","image/jpeg"].includes(C));for(const C of y)v(await f.getType(C)),u.preventDefault()}});let d=0;e.htmlElement.ondragover=u=>{u.preventDefault(),u.dataTransfer&&(e.setClass("ondrag"),d!=0&&(window.clearTimeout(d),d=0),d=window.setTimeout(()=>{e.unsetClass("ondrag"),d=0},200))},e.htmlElement.ondrop=u=>{if(u.preventDefault(),u.dataTransfer){e.unsetClass("ondrag");let b=u.dataTransfer.files;for(let f of b)console.log(f.type),["image/png","image/jpeg"].includes(f.type)&&v(f)}},s.onAction=()=>{let u=new $e;u.add(new g("div","Add Image","chat-add-media-header"));let b=new B("image","your image","file");b.setClass("chat-add-media-input"),b.htmlElement.accept="image/png, image/jpeg",u.add(b);let f=new _e("Upload");f.onClick=()=>{let y=b.htmlElement.files;if(!(y==null||y.length==0)){for(let C of y)["image/png","image/jpeg"].includes(C.type)&&v(C);u.dispose()}},u.add(f)};const v=u=>{var b=new FileReader;b.readAsDataURL(u),b.onloadend=function(){var f=""+b.result;let y=new ht(f);y.onRemove=()=>{t.remove(y),t.getChildren().length==0&&t.hide()},t.add(y),t.show()}};let k=h.getCurrentConversation();k&&this.registerConversationListener(k);let T=new ce;T.onConversationSelected=(u,b)=>{this.registerConversationListener(b),l(b.getModel())}}registerConversationListener(e){let t=new ze;t.onDraftChanged=(n,s)=>{console.log(n),this.input.htmlElement.value=n,this.onUpdateInput()},e.addListener(t)}onUpdateInput(){this.input.htmlElement.value!=""?(this.call.hide(),this.send.show()):(this.send.hide(),this.call.show()),this.input.htmlElement.style.height="auto";let e=this.input.htmlElement.scrollHeight;e>=window.innerHeight*.4&&(e=window.innerHeight*.4),this.input.htmlElement.style.height=""+e+"px"}}class ht extends g{constructor(e){super("div","","image"),this.base64data=e;let t=new g("img");t.htmlElement.src=e,this.add(t);let n=new L(K,()=>{this.onRemove()});this.add(n)}getImageURL(){return this.base64data}onRemove(){alert("Must be overwritten by creator!")}}function he(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var z=he();function Me(i){z=i}var O={exec:()=>null};function m(i,e=""){let t=typeof i=="string"?i:i.source;const n={replace:(s,r)=>{let o=typeof r=="string"?r:r.source;return o=o.replace(E.caret,"$1"),t=t.replace(s,o),n},getRegex:()=>new RegExp(t,e)};return n}var E={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:i=>new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}#`),htmlBeginRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}<(?:[a-z].*>|!--)`,"i")},pt=/^(?:[ \t]*(?:\n|$))+/,ut=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,dt=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,F=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,gt=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,pe=/(?:[*+-]|\d{1,9}[.)])/,Pe=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,De=m(Pe).replace(/bull/g,pe).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),mt=m(Pe).replace(/bull/g,pe).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),ue=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ft=/^[^\n]+/,de=/(?!\s*\])(?:\\.|[^\[\]\\])+/,wt=m(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",de).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),kt=m(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,pe).getRegex(),V="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ge=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,xt=m("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",ge).replace("tag",V).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Be=m(ue).replace("hr",F).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",V).getRegex(),bt=m(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Be).getRegex(),me={blockquote:bt,code:ut,def:wt,fences:dt,heading:gt,hr:F,html:xt,lheading:De,list:kt,newline:pt,paragraph:Be,table:O,text:ft},Ce=m("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",F).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",V).getRegex(),vt={...me,lheading:mt,table:Ce,paragraph:m(ue).replace("hr",F).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ce).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",V).getRegex()},yt={...me,html:m(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ge).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:O,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:m(ue).replace("hr",F).replace("heading",` *#{1,6} *[^
]`).replace("lheading",De).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Ct=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,St=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Oe=/^( {2,}|\\)\n(?!\s*$)/,Tt=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Y=/[\p{P}\p{S}]/u,fe=/[\s\p{P}\p{S}]/u,Ne=/[^\s\p{P}\p{S}]/u,Et=m(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,fe).getRegex(),Fe=/(?!~)[\p{P}\p{S}]/u,Lt=/(?!~)[\s\p{P}\p{S}]/u,Rt=/(?:[^\s\p{P}\p{S}]|~)/u,It=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,qe=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,_t=m(qe,"u").replace(/punct/g,Y).getRegex(),At=m(qe,"u").replace(/punct/g,Fe).getRegex(),Ue="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",$t=m(Ue,"gu").replace(/notPunctSpace/g,Ne).replace(/punctSpace/g,fe).replace(/punct/g,Y).getRegex(),zt=m(Ue,"gu").replace(/notPunctSpace/g,Rt).replace(/punctSpace/g,Lt).replace(/punct/g,Fe).getRegex(),Mt=m("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Ne).replace(/punctSpace/g,fe).replace(/punct/g,Y).getRegex(),Pt=m(/\\(punct)/,"gu").replace(/punct/g,Y).getRegex(),Dt=m(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Bt=m(ge).replace("(?:-->|$)","-->").getRegex(),Ot=m("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Bt).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Z=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Nt=m(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Z).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),He=m(/^!?\[(label)\]\[(ref)\]/).replace("label",Z).replace("ref",de).getRegex(),je=m(/^!?\[(ref)\](?:\[\])?/).replace("ref",de).getRegex(),Ft=m("reflink|nolink(?!\\()","g").replace("reflink",He).replace("nolink",je).getRegex(),we={_backpedal:O,anyPunctuation:Pt,autolink:Dt,blockSkip:It,br:Oe,code:St,del:O,emStrongLDelim:_t,emStrongRDelimAst:$t,emStrongRDelimUnd:Mt,escape:Ct,link:Nt,nolink:je,punctuation:Et,reflink:He,reflinkSearch:Ft,tag:Ot,text:Tt,url:O},qt={...we,link:m(/^!?\[(label)\]\((.*?)\)/).replace("label",Z).getRegex(),reflink:m(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Z).getRegex()},re={...we,emStrongRDelimAst:zt,emStrongLDelim:At,url:m(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Ut={...re,br:m(Oe).replace("{2,}","*").getRegex(),text:m(re.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},H={normal:me,gfm:vt,pedantic:yt},P={normal:we,gfm:re,breaks:Ut,pedantic:qt},Ht={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Se=i=>Ht[i];function R(i,e){if(e){if(E.escapeTest.test(i))return i.replace(E.escapeReplace,Se)}else if(E.escapeTestNoEncode.test(i))return i.replace(E.escapeReplaceNoEncode,Se);return i}function Te(i){try{i=encodeURI(i).replace(E.percentDecode,"%")}catch{return null}return i}function Ee(i,e){const t=i.replace(E.findPipe,(r,o,l)=>{let c=!1,a=o;for(;--a>=0&&l[a]==="\\";)c=!c;return c?"|":" |"}),n=t.split(E.splitPipe);let s=0;if(n[0].trim()||n.shift(),n.length>0&&!n.at(-1)?.trim()&&n.pop(),e)if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;s<n.length;s++)n[s]=n[s].trim().replace(E.slashPipe,"|");return n}function D(i,e,t){const n=i.length;if(n===0)return"";let s=0;for(;s<n&&i.charAt(n-s-1)===e;)s++;return i.slice(0,n-s)}function jt(i,e){if(i.indexOf(e[1])===-1)return-1;let t=0;for(let n=0;n<i.length;n++)if(i[n]==="\\")n++;else if(i[n]===e[0])t++;else if(i[n]===e[1]&&(t--,t<0))return n;return t>0?-2:-1}function Le(i,e,t,n,s){const r=e.href,o=e.title||null,l=i[1].replace(s.other.outputLinkReplace,"$1");n.state.inLink=!0;const c={type:i[0].charAt(0)==="!"?"image":"link",raw:t,href:r,title:o,text:l,tokens:n.inlineTokens(l)};return n.state.inLink=!1,c}function Wt(i,e,t){const n=i.match(t.other.indentCodeCompensation);if(n===null)return e;const s=n[1];return e.split(`
`).map(r=>{const o=r.match(t.other.beginningSpace);if(o===null)return r;const[l]=o;return l.length>=s.length?r.slice(s.length):r}).join(`
`)}var J=class{options;rules;lexer;constructor(i){this.options=i||z}space(i){const e=this.rules.block.newline.exec(i);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(i){const e=this.rules.block.code.exec(i);if(e){const t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:D(t,`
`)}}}fences(i){const e=this.rules.block.fences.exec(i);if(e){const t=e[0],n=Wt(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:n}}}heading(i){const e=this.rules.block.heading.exec(i);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){const n=D(t,"#");(this.options.pedantic||!n||this.rules.other.endingSpaceChar.test(n))&&(t=n.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(i){const e=this.rules.block.hr.exec(i);if(e)return{type:"hr",raw:D(e[0],`
`)}}blockquote(i){const e=this.rules.block.blockquote.exec(i);if(e){let t=D(e[0],`
`).split(`
`),n="",s="";const r=[];for(;t.length>0;){let o=!1;const l=[];let c;for(c=0;c<t.length;c++)if(this.rules.other.blockquoteStart.test(t[c]))l.push(t[c]),o=!0;else if(!o)l.push(t[c]);else break;t=t.slice(c);const a=l.join(`
`),p=a.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}
${a}`:a,s=s?`${s}
${p}`:p;const x=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(p,r,!0),this.lexer.state.top=x,t.length===0)break;const d=r.at(-1);if(d?.type==="code")break;if(d?.type==="blockquote"){const v=d,k=v.raw+`
`+t.join(`
`),T=this.blockquote(k);r[r.length-1]=T,n=n.substring(0,n.length-v.raw.length)+T.raw,s=s.substring(0,s.length-v.text.length)+T.text;break}else if(d?.type==="list"){const v=d,k=v.raw+`
`+t.join(`
`),T=this.list(k);r[r.length-1]=T,n=n.substring(0,n.length-d.raw.length)+T.raw,s=s.substring(0,s.length-v.raw.length)+T.raw,t=k.substring(r.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:n,tokens:r,text:s}}}list(i){let e=this.rules.block.list.exec(i);if(e){let t=e[1].trim();const n=t.length>1,s={type:"list",raw:"",ordered:n,start:n?+t.slice(0,-1):"",loose:!1,items:[]};t=n?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=n?t:"[*+-]");const r=this.rules.other.listItemRegex(t);let o=!1;for(;i;){let c=!1,a="",p="";if(!(e=r.exec(i))||this.rules.block.hr.test(i))break;a=e[0],i=i.substring(a.length);let x=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,b=>" ".repeat(3*b.length)),d=i.split(`
`,1)[0],v=!x.trim(),k=0;if(this.options.pedantic?(k=2,p=x.trimStart()):v?k=e[1].length+1:(k=e[2].search(this.rules.other.nonSpaceChar),k=k>4?1:k,p=x.slice(k),k+=e[1].length),v&&this.rules.other.blankLine.test(d)&&(a+=d+`
`,i=i.substring(d.length+1),c=!0),!c){const b=this.rules.other.nextBulletRegex(k),f=this.rules.other.hrRegex(k),y=this.rules.other.fencesBeginRegex(k),C=this.rules.other.headingBeginRegex(k),X=this.rules.other.htmlBeginRegex(k);for(;i;){const ee=i.split(`
`,1)[0];let M;if(d=ee,this.options.pedantic?(d=d.replace(this.rules.other.listReplaceNesting,"  "),M=d):M=d.replace(this.rules.other.tabCharGlobal,"    "),y.test(d)||C.test(d)||X.test(d)||b.test(d)||f.test(d))break;if(M.search(this.rules.other.nonSpaceChar)>=k||!d.trim())p+=`
`+M.slice(k);else{if(v||x.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||y.test(x)||C.test(x)||f.test(x))break;p+=`
`+d}!v&&!d.trim()&&(v=!0),a+=ee+`
`,i=i.substring(ee.length+1),x=M.slice(k)}}s.loose||(o?s.loose=!0:this.rules.other.doubleBlankLine.test(a)&&(o=!0));let T=null,u;this.options.gfm&&(T=this.rules.other.listIsTask.exec(p),T&&(u=T[0]!=="[ ] ",p=p.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:a,task:!!T,checked:u,loose:!1,text:p,tokens:[]}),s.raw+=a}const l=s.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let c=0;c<s.items.length;c++)if(this.lexer.state.top=!1,s.items[c].tokens=this.lexer.blockTokens(s.items[c].text,[]),!s.loose){const a=s.items[c].tokens.filter(x=>x.type==="space"),p=a.length>0&&a.some(x=>this.rules.other.anyLine.test(x.raw));s.loose=p}if(s.loose)for(let c=0;c<s.items.length;c++)s.items[c].loose=!0;return s}}html(i){const e=this.rules.block.html.exec(i);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(i){const e=this.rules.block.def.exec(i);if(e){const t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:n,title:s}}}table(i){const e=this.rules.block.table.exec(i);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;const t=Ee(e[1]),n=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=e[3]?.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],r={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===n.length){for(const o of n)this.rules.other.tableAlignRight.test(o)?r.align.push("right"):this.rules.other.tableAlignCenter.test(o)?r.align.push("center"):this.rules.other.tableAlignLeft.test(o)?r.align.push("left"):r.align.push(null);for(let o=0;o<t.length;o++)r.header.push({text:t[o],tokens:this.lexer.inline(t[o]),header:!0,align:r.align[o]});for(const o of s)r.rows.push(Ee(o,r.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:r.align[c]})));return r}}lheading(i){const e=this.rules.block.lheading.exec(i);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(i){const e=this.rules.block.paragraph.exec(i);if(e){const t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(i){const e=this.rules.block.text.exec(i);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(i){const e=this.rules.inline.escape.exec(i);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(i){const e=this.rules.inline.tag.exec(i);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(i){const e=this.rules.inline.link.exec(i);if(e){const t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;const r=D(t.slice(0,-1),"\\");if((t.length-r.length)%2===0)return}else{const r=jt(e[2],"()");if(r===-2)return;if(r>-1){const l=(e[0].indexOf("!")===0?5:4)+e[1].length+r;e[2]=e[2].substring(0,r),e[0]=e[0].substring(0,l).trim(),e[3]=""}}let n=e[2],s="";if(this.options.pedantic){const r=this.rules.other.pedanticHrefTitle.exec(n);r&&(n=r[1],s=r[3])}else s=e[3]?e[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?n=n.slice(1):n=n.slice(1,-1)),Le(e,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(i,e){let t;if((t=this.rules.inline.reflink.exec(i))||(t=this.rules.inline.nolink.exec(i))){const n=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=e[n.toLowerCase()];if(!s){const r=t[0].charAt(0);return{type:"text",raw:r,text:r}}return Le(t,s,t[0],this.lexer,this.rules)}}emStrong(i,e,t=""){let n=this.rules.inline.emStrongLDelim.exec(i);if(!n||n[3]&&t.match(this.rules.other.unicodeAlphaNumeric))return;if(!(n[1]||n[2]||"")||!t||this.rules.inline.punctuation.exec(t)){const r=[...n[0]].length-1;let o,l,c=r,a=0;const p=n[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(p.lastIndex=0,e=e.slice(-1*i.length+r);(n=p.exec(e))!=null;){if(o=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!o)continue;if(l=[...o].length,n[3]||n[4]){c+=l;continue}else if((n[5]||n[6])&&r%3&&!((r+l)%3)){a+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+a);const x=[...n[0]][0].length,d=i.slice(0,r+n.index+x+l);if(Math.min(r,l)%2){const k=d.slice(1,-1);return{type:"em",raw:d,text:k,tokens:this.lexer.inlineTokens(k)}}const v=d.slice(2,-2);return{type:"strong",raw:d,text:v,tokens:this.lexer.inlineTokens(v)}}}}codespan(i){const e=this.rules.inline.code.exec(i);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," ");const n=this.rules.other.nonSpaceChar.test(t),s=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return n&&s&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(i){const e=this.rules.inline.br.exec(i);if(e)return{type:"br",raw:e[0]}}del(i){const e=this.rules.inline.del.exec(i);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(i){const e=this.rules.inline.autolink.exec(i);if(e){let t,n;return e[2]==="@"?(t=e[1],n="mailto:"+t):(t=e[1],n=t),{type:"link",raw:e[0],text:t,href:n,tokens:[{type:"text",raw:t,text:t}]}}}url(i){let e;if(e=this.rules.inline.url.exec(i)){let t,n;if(e[2]==="@")t=e[0],n="mailto:"+t;else{let s;do s=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])?.[0]??"";while(s!==e[0]);t=e[0],e[1]==="www."?n="http://"+e[0]:n=e[0]}return{type:"link",raw:e[0],text:t,href:n,tokens:[{type:"text",raw:t,text:t}]}}}inlineText(i){const e=this.rules.inline.text.exec(i);if(e){const t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},I=class oe{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||z,this.options.tokenizer=this.options.tokenizer||new J,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:E,block:H.normal,inline:P.normal};this.options.pedantic?(t.block=H.pedantic,t.inline=P.pedantic):this.options.gfm&&(t.block=H.gfm,this.options.breaks?t.inline=P.breaks:t.inline=P.gfm),this.tokenizer.rules=t}static get rules(){return{block:H,inline:P}}static lex(e,t){return new oe(t).lex(e)}static lexInline(e,t){return new oe(t).inlineTokens(e)}lex(e){e=e.replace(E.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const n=this.inlineQueue[t];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){for(this.options.pedantic&&(e=e.replace(E.tabCharGlobal,"    ").replace(E.spaceLine,""));e;){let s;if(this.options.extensions?.block?.some(o=>(s=o.call({lexer:this},e,t))?(e=e.substring(s.raw.length),t.push(s),!0):!1))continue;if(s=this.tokenizer.space(e)){e=e.substring(s.raw.length);const o=t.at(-1);s.raw.length===1&&o!==void 0?o.raw+=`
`:t.push(s);continue}if(s=this.tokenizer.code(e)){e=e.substring(s.raw.length);const o=t.at(-1);o?.type==="paragraph"||o?.type==="text"?(o.raw+=`
`+s.raw,o.text+=`
`+s.text,this.inlineQueue.at(-1).src=o.text):t.push(s);continue}if(s=this.tokenizer.fences(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.heading(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.hr(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.blockquote(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.list(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.html(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.def(e)){e=e.substring(s.raw.length);const o=t.at(-1);o?.type==="paragraph"||o?.type==="text"?(o.raw+=`
`+s.raw,o.text+=`
`+s.raw,this.inlineQueue.at(-1).src=o.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title});continue}if(s=this.tokenizer.table(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.lheading(e)){e=e.substring(s.raw.length),t.push(s);continue}let r=e;if(this.options.extensions?.startBlock){let o=1/0;const l=e.slice(1);let c;this.options.extensions.startBlock.forEach(a=>{c=a.call({lexer:this},l),typeof c=="number"&&c>=0&&(o=Math.min(o,c))}),o<1/0&&o>=0&&(r=e.substring(0,o+1))}if(this.state.top&&(s=this.tokenizer.paragraph(r))){const o=t.at(-1);n&&o?.type==="paragraph"?(o.raw+=`
`+s.raw,o.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):t.push(s),n=r.length!==e.length,e=e.substring(s.raw.length);continue}if(s=this.tokenizer.text(e)){e=e.substring(s.raw.length);const o=t.at(-1);o?.type==="text"?(o.raw+=`
`+s.raw,o.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):t.push(s);continue}if(e){const o="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(o);break}else throw new Error(o)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n=e,s=null;if(this.tokens.links){const l=Object.keys(this.tokens.links);if(l.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(n))!=null;)l.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(n))!=null;)n=n.slice(0,s.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(s=this.tokenizer.rules.inline.blockSkip.exec(n))!=null;)n=n.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let r=!1,o="";for(;e;){r||(o=""),r=!1;let l;if(this.options.extensions?.inline?.some(a=>(l=a.call({lexer:this},e,t))?(e=e.substring(l.raw.length),t.push(l),!0):!1))continue;if(l=this.tokenizer.escape(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.tag(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.link(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(l.raw.length);const a=t.at(-1);l.type==="text"&&a?.type==="text"?(a.raw+=l.raw,a.text+=l.text):t.push(l);continue}if(l=this.tokenizer.emStrong(e,n,o)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.codespan(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.br(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.del(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.autolink(e)){e=e.substring(l.raw.length),t.push(l);continue}if(!this.state.inLink&&(l=this.tokenizer.url(e))){e=e.substring(l.raw.length),t.push(l);continue}let c=e;if(this.options.extensions?.startInline){let a=1/0;const p=e.slice(1);let x;this.options.extensions.startInline.forEach(d=>{x=d.call({lexer:this},p),typeof x=="number"&&x>=0&&(a=Math.min(a,x))}),a<1/0&&a>=0&&(c=e.substring(0,a+1))}if(l=this.tokenizer.inlineText(c)){e=e.substring(l.raw.length),l.raw.slice(-1)!=="_"&&(o=l.raw.slice(-1)),r=!0;const a=t.at(-1);a?.type==="text"?(a.raw+=l.raw,a.text+=l.text):t.push(l);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return t}},Q=class{options;parser;constructor(i){this.options=i||z}space(i){return""}code({text:i,lang:e,escaped:t}){const n=(e||"").match(E.notSpaceStart)?.[0],s=i.replace(E.endingNewline,"")+`
`;return n?'<pre><code class="language-'+R(n)+'">'+(t?s:R(s,!0))+`</code></pre>
`:"<pre><code>"+(t?s:R(s,!0))+`</code></pre>
`}blockquote({tokens:i}){return`<blockquote>
${this.parser.parse(i)}</blockquote>
`}html({text:i}){return i}heading({tokens:i,depth:e}){return`<h${e}>${this.parser.parseInline(i)}</h${e}>
`}hr(i){return`<hr>
`}list(i){const e=i.ordered,t=i.start;let n="";for(let o=0;o<i.items.length;o++){const l=i.items[o];n+=this.listitem(l)}const s=e?"ol":"ul",r=e&&t!==1?' start="'+t+'"':"";return"<"+s+r+`>
`+n+"</"+s+`>
`}listitem(i){let e="";if(i.task){const t=this.checkbox({checked:!!i.checked});i.loose?i.tokens[0]?.type==="paragraph"?(i.tokens[0].text=t+" "+i.tokens[0].text,i.tokens[0].tokens&&i.tokens[0].tokens.length>0&&i.tokens[0].tokens[0].type==="text"&&(i.tokens[0].tokens[0].text=t+" "+R(i.tokens[0].tokens[0].text),i.tokens[0].tokens[0].escaped=!0)):i.tokens.unshift({type:"text",raw:t+" ",text:t+" ",escaped:!0}):e+=t+" "}return e+=this.parser.parse(i.tokens,!!i.loose),`<li>${e}</li>
`}checkbox({checked:i}){return"<input "+(i?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:i}){return`<p>${this.parser.parseInline(i)}</p>
`}table(i){let e="",t="";for(let s=0;s<i.header.length;s++)t+=this.tablecell(i.header[s]);e+=this.tablerow({text:t});let n="";for(let s=0;s<i.rows.length;s++){const r=i.rows[s];t="";for(let o=0;o<r.length;o++)t+=this.tablecell(r[o]);n+=this.tablerow({text:t})}return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+n+`</table>
`}tablerow({text:i}){return`<tr>
${i}</tr>
`}tablecell(i){const e=this.parser.parseInline(i.tokens),t=i.header?"th":"td";return(i.align?`<${t} align="${i.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:i}){return`<strong>${this.parser.parseInline(i)}</strong>`}em({tokens:i}){return`<em>${this.parser.parseInline(i)}</em>`}codespan({text:i}){return`<code>${R(i,!0)}</code>`}br(i){return"<br>"}del({tokens:i}){return`<del>${this.parser.parseInline(i)}</del>`}link({href:i,title:e,tokens:t}){const n=this.parser.parseInline(t),s=Te(i);if(s===null)return n;i=s;let r='<a href="'+i+'"';return e&&(r+=' title="'+R(e)+'"'),r+=">"+n+"</a>",r}image({href:i,title:e,text:t,tokens:n}){n&&(t=this.parser.parseInline(n,this.parser.textRenderer));const s=Te(i);if(s===null)return R(t);i=s;let r=`<img src="${i}" alt="${t}"`;return e&&(r+=` title="${R(e)}"`),r+=">",r}text(i){return"tokens"in i&&i.tokens?this.parser.parseInline(i.tokens):"escaped"in i&&i.escaped?i.text:R(i.text)}},ke=class{strong({text:i}){return i}em({text:i}){return i}codespan({text:i}){return i}del({text:i}){return i}html({text:i}){return i}text({text:i}){return i}link({text:i}){return""+i}image({text:i}){return""+i}br(){return""}},_=class le{options;renderer;textRenderer;constructor(e){this.options=e||z,this.options.renderer=this.options.renderer||new Q,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ke}static parse(e,t){return new le(t).parse(e)}static parseInline(e,t){return new le(t).parseInline(e)}parse(e,t=!0){let n="";for(let s=0;s<e.length;s++){const r=e[s];if(this.options.extensions?.renderers?.[r.type]){const l=r,c=this.options.extensions.renderers[l.type].call({parser:this},l);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(l.type)){n+=c||"";continue}}const o=r;switch(o.type){case"space":{n+=this.renderer.space(o);continue}case"hr":{n+=this.renderer.hr(o);continue}case"heading":{n+=this.renderer.heading(o);continue}case"code":{n+=this.renderer.code(o);continue}case"table":{n+=this.renderer.table(o);continue}case"blockquote":{n+=this.renderer.blockquote(o);continue}case"list":{n+=this.renderer.list(o);continue}case"html":{n+=this.renderer.html(o);continue}case"paragraph":{n+=this.renderer.paragraph(o);continue}case"text":{let l=o,c=this.renderer.text(l);for(;s+1<e.length&&e[s+1].type==="text";)l=e[++s],c+=`
`+this.renderer.text(l);t?n+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c,escaped:!0}]}):n+=c;continue}default:{const l='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return n}parseInline(e,t=this.renderer){let n="";for(let s=0;s<e.length;s++){const r=e[s];if(this.options.extensions?.renderers?.[r.type]){const l=this.options.extensions.renderers[r.type].call({parser:this},r);if(l!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type)){n+=l||"";continue}}const o=r;switch(o.type){case"escape":{n+=t.text(o);break}case"html":{n+=t.html(o);break}case"link":{n+=t.link(o);break}case"image":{n+=t.image(o);break}case"strong":{n+=t.strong(o);break}case"em":{n+=t.em(o);break}case"codespan":{n+=t.codespan(o);break}case"br":{n+=t.br(o);break}case"del":{n+=t.del(o);break}case"text":{n+=t.text(o);break}default:{const l='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return n}},W=class{options;block;constructor(i){this.options=i||z}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(i){return i}postprocess(i){return i}processAllTokens(i){return i}provideLexer(){return this.block?I.lex:I.lexInline}provideParser(){return this.block?_.parse:_.parseInline}},Gt=class{defaults=he();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=_;Renderer=Q;TextRenderer=ke;Lexer=I;Tokenizer=J;Hooks=W;constructor(...i){this.use(...i)}walkTokens(i,e){let t=[];for(const n of i)switch(t=t.concat(e.call(this,n)),n.type){case"table":{const s=n;for(const r of s.header)t=t.concat(this.walkTokens(r.tokens,e));for(const r of s.rows)for(const o of r)t=t.concat(this.walkTokens(o.tokens,e));break}case"list":{const s=n;t=t.concat(this.walkTokens(s.items,e));break}default:{const s=n;this.defaults.extensions?.childTokens?.[s.type]?this.defaults.extensions.childTokens[s.type].forEach(r=>{const o=s[r].flat(1/0);t=t.concat(this.walkTokens(o,e))}):s.tokens&&(t=t.concat(this.walkTokens(s.tokens,e)))}}return t}use(...i){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return i.forEach(t=>{const n={...t};if(n.async=this.defaults.async||n.async||!1,t.extensions&&(t.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const r=e.renderers[s.name];r?e.renderers[s.name]=function(...o){let l=s.renderer.apply(this,o);return l===!1&&(l=r.apply(this,o)),l}:e.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const r=e[s.level];r?r.unshift(s.tokenizer):e[s.level]=[s.tokenizer],s.start&&(s.level==="block"?e.startBlock?e.startBlock.push(s.start):e.startBlock=[s.start]:s.level==="inline"&&(e.startInline?e.startInline.push(s.start):e.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(e.childTokens[s.name]=s.childTokens)}),n.extensions=e),t.renderer){const s=this.defaults.renderer||new Q(this.defaults);for(const r in t.renderer){if(!(r in s))throw new Error(`renderer '${r}' does not exist`);if(["options","parser"].includes(r))continue;const o=r,l=t.renderer[o],c=s[o];s[o]=(...a)=>{let p=l.apply(s,a);return p===!1&&(p=c.apply(s,a)),p||""}}n.renderer=s}if(t.tokenizer){const s=this.defaults.tokenizer||new J(this.defaults);for(const r in t.tokenizer){if(!(r in s))throw new Error(`tokenizer '${r}' does not exist`);if(["options","rules","lexer"].includes(r))continue;const o=r,l=t.tokenizer[o],c=s[o];s[o]=(...a)=>{let p=l.apply(s,a);return p===!1&&(p=c.apply(s,a)),p}}n.tokenizer=s}if(t.hooks){const s=this.defaults.hooks||new W;for(const r in t.hooks){if(!(r in s))throw new Error(`hook '${r}' does not exist`);if(["options","block"].includes(r))continue;const o=r,l=t.hooks[o],c=s[o];W.passThroughHooks.has(r)?s[o]=a=>{if(this.defaults.async)return Promise.resolve(l.call(s,a)).then(x=>c.call(s,x));const p=l.call(s,a);return c.call(s,p)}:s[o]=(...a)=>{let p=l.apply(s,a);return p===!1&&(p=c.apply(s,a)),p}}n.hooks=s}if(t.walkTokens){const s=this.defaults.walkTokens,r=t.walkTokens;n.walkTokens=function(o){let l=[];return l.push(r.call(this,o)),s&&(l=l.concat(s.call(this,o))),l}}this.defaults={...this.defaults,...n}}),this}setOptions(i){return this.defaults={...this.defaults,...i},this}lexer(i,e){return I.lex(i,e??this.defaults)}parser(i,e){return _.parse(i,e??this.defaults)}parseMarkdown(i){return(t,n)=>{const s={...n},r={...this.defaults,...s},o=this.onError(!!r.silent,!!r.async);if(this.defaults.async===!0&&s.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));r.hooks&&(r.hooks.options=r,r.hooks.block=i);const l=r.hooks?r.hooks.provideLexer():i?I.lex:I.lexInline,c=r.hooks?r.hooks.provideParser():i?_.parse:_.parseInline;if(r.async)return Promise.resolve(r.hooks?r.hooks.preprocess(t):t).then(a=>l(a,r)).then(a=>r.hooks?r.hooks.processAllTokens(a):a).then(a=>r.walkTokens?Promise.all(this.walkTokens(a,r.walkTokens)).then(()=>a):a).then(a=>c(a,r)).then(a=>r.hooks?r.hooks.postprocess(a):a).catch(o);try{r.hooks&&(t=r.hooks.preprocess(t));let a=l(t,r);r.hooks&&(a=r.hooks.processAllTokens(a)),r.walkTokens&&this.walkTokens(a,r.walkTokens);let p=c(a,r);return r.hooks&&(p=r.hooks.postprocess(p)),p}catch(a){return o(a)}}}onError(i,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,i){const n="<p>An error occurred:</p><pre>"+R(t.message+"",!0)+"</pre>";return e?Promise.resolve(n):n}if(e)return Promise.reject(t);throw t}}},$=new Gt;function w(i,e){return $.parse(i,e)}w.options=w.setOptions=function(i){return $.setOptions(i),w.defaults=$.defaults,Me(w.defaults),w};w.getDefaults=he;w.defaults=z;w.use=function(...i){return $.use(...i),w.defaults=$.defaults,Me(w.defaults),w};w.walkTokens=function(i,e){return $.walkTokens(i,e)};w.parseInline=$.parseInline;w.Parser=_;w.parser=_.parse;w.Renderer=Q;w.TextRenderer=ke;w.Lexer=I;w.lexer=I.lex;w.Tokenizer=J;w.Hooks=W;w.parse=w;w.options;w.setOptions;w.use;w.walkTokens;w.parseInline;var Re=w;_.parse;I.lex;async function Zt(i){navigator.clipboard||alert("Browser don't have support for native clipboard."),await navigator.clipboard.writeText(i)}class Jt extends g{constructor(e){super("div","","message-tool-bar"),this.add(new L(Ye,()=>{Zt(e.getText().trim())})),e.getRole()!="user"?this.add(new L(Xe,()=>{let t=new j("Are you sure? (This will delete the message and all newer messages!)","Yes","Cancel");t.onConfirm=()=>{let n=h.getCurrentConversation();if(n){let s=n.getMessages(),r=s.indexOf(e)-1;if(r>=0){let o=s[r];n.deleteMessages(o),n.sendMessage(o.getText(),o.getImages())}}},t.onCancel=()=>{}})):(this.add(new L(Ie,()=>{let t=new j("Are you sure? (This will delete the message and all newer messages!)","Yes","Cancel");t.onConfirm=()=>{let n=h.getCurrentConversation();n&&(n.setDraftText(e.getText()),n.setDraftImages(e.getImages()),n.deleteMessages(e))},t.onCancel=()=>{}})),this.add(new L(K,()=>{let t=new j("Are you sure? (This will delete the message and all newer messages!)","Yes","Cancel");t.onConfirm=()=>{let n=h.getCurrentConversation();n&&n.deleteMessages(e)},t.onCancel=()=>{}})))}}class Qt extends g{constructor(e,t){super("div","","thought");var n=new g("div",ie+" Thought (click to expand/collapse)","thought-header");this.add(n);var s=new g("div",e);t||s.hide(),this.add(s),this.htmlElement.onclick=()=>{s.isVisible()?s.hide():s.show()}}}class Kt extends g{content;modelDiv;constructor(e){super("div","","message-container");let t=e.getRole();t.startsWith("local/")&&(t=t.replace("local/","")),this.modelDiv=new g("div",t,"model"),this.add(this.modelDiv),e.getRole()=="user"?(this.modelDiv.hide(),this.setClass("from-user")):this.setClass("from-model"),this.add(new Jt(e));for(let s of e.getImages()){let r=new g("img");r.htmlElement.src=s,this.add(r)}this.content=new g("div","","message-body"),this.add(this.content),this.renderText(e);let n=new it;n.onExtendText=s=>{this.renderText(e)},e.addListener(n)}renderText(e){this.content.htmlElement.innerHTML="";let t=e.getText().split("</think>");for(let n of t.keys()){let s=t[n].trim();if(s.startsWith("<think>")){let r=Re(s.replace("<think>","")),o=n==t.length-1;this.content.add(new Qt(r,o))}else{let r=Re(s);this.content.add(new g("div",r))}}}}class Vt extends g{constructor(){super("div","","chat-history");let e=new ce;e.onConversationSelected=(n,s)=>{this.renderMessages(s)},h.addListener(e);let t=h.getCurrentConversation();t&&this.renderMessages(t)}addMessage(e){let t=new Kt(e);this.add(t),setTimeout(()=>{this.htmlElement.scrollTo(0,this.htmlElement.scrollHeight)},0)}renderMessages(e){this.htmlElement.innerHTML="";for(let n of e.getMessages())this.addMessage(n);let t=new ze;t.onMessageAdded=n=>{this.addMessage(n)},t.onMessageDeletedFrom=(n,s)=>{for(;this.htmlElement.children.length>n;)this.htmlElement.removeChild(this.htmlElement.children[n])},e.addListener(t)}}class Yt extends g{constructor(e,t){super("div",e,"removableItem");let n=new L(K);n.setClass("right"),n.onAction=()=>{this.hide(),t()},this.add(n)}}function Xt(){let i=new $e("popupContent-fullscreen");i.add(new xe("Connections"));let e=A.getInstance().getConnections();for(let o of e)i.add(new Yt(o.name+" ("+o.apiEndpoint+")",()=>{A.getInstance().removeConnection(o)}));i.add(new xe("Add Connection","h2")),i.add(new te("name"));let t=new B("apiName","Ollama","text");i.add(t),i.add(new te("apiEndpoint"));let n=new B("apiEndpoint","localhost:11435","text");i.add(n),i.add(new te("apiKey"));let s=new B("apiKey","f5a20...","password");i.add(s);let r=new _e("Add Connection","buttonWide");r.onClick=()=>{if(t.value()==""){alert("name must not be empty!");return}if(n.value()==""){alert("apiEndpoint must not be empty!");return}if(s.value()==""){alert("apiKey must not be empty!");return}A.getInstance().addConnection(t.value(),n.value(),s.value()),i.dispose()},i.add(r)}class en extends g{constructor(){super("div","","chat");let e=new g("div","","chat-header"),t=new L(nt);e.add(t);let n=new g("span","","fill-width");n.setClass("main-header");let s=new g("span","Unnamed Chat");s.setClass("centered-text"),n.add(s);let r=new L(Ie);r.htmlElement.style.fontSize="0.8em",r.htmlElement.style.marginLeft="0.4em",r.htmlElement.style.fontWeight="normal",n.add(r),e.add(n);let o=new L(K);e.add(o);let l=new L(et);e.add(l),this.add(e),this.add(new Vt),this.add(new ct),h.addListener(new class extends ce{onCurrentConversationChanged(){let c=h.getCurrentConversation();c&&(s.htmlElement.textContent=c.getName())}}),r.onAction=()=>{s.htmlElement.textContent=prompt("Rename chat:",s.htmlElement.textContent||"Unnamed Chat")||"Unnamed Chat ";let c=h.getCurrentConversation();c&&c.setName(s.htmlElement.textContent.trim())},o.onAction=()=>{let c=new j("Are you sure? (Will delete the entire conversation history)","Yes","Cancel");c.onConfirm=()=>{let a=h.getCurrentConversation();a&&a.deleteMessages(a.getMessages()[0])},c.onCancel=()=>{}},l.onAction=()=>{Xt()}}update(e,t){}}async function tn(){Ge(),document.getElementsByTagName("title")[0].innerHTML=se.APPNAME;let i=Object.entries(h.getConversations());if(i.length==0)h.newConversation();else{let e=i.reduce((n,s)=>n[1].modified>s[1].modified?n:s);h.selectConversation(e[0])||console.log("Could not select conversation:",e[0])}new Ze("chat",{chat:new en})}tn();
